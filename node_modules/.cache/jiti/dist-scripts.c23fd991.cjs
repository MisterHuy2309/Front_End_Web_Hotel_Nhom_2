"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.createSpyProxy = createSpyProxy;Object.defineProperty(exports, "resolveScriptKey", { enumerable: true, get: function () {return _unheadB578PsDV.r;} });Object.defineProperty(exports, "useScript", { enumerable: true, get: function () {return _unheadB578PsDV.u;} });var _unheadB578PsDV = require("./shared/unhead.B578PsDV.mjs");
require("./shared/unhead.yem5I2v_.mjs");

function createSpyProxy(target, onApply) {
  const stack = [];
  let stackIdx = -1;
  const handler = (reuseStack = false) => ({
    get(_, prop, receiver) {
      if (!reuseStack) {
        stackIdx++;
        stack[stackIdx] = [];
      }
      const v = Reflect.get(_, prop, receiver);
      if (typeof v === "object" || typeof v === "function") {
        stack[stackIdx].push({ type: "get", key: prop });
        return new Proxy(v, handler(true));
      }
      stack[stackIdx].push({ type: "get", key: prop, value: v });
      return v;
    },
    apply(_, __, args) {
      stack[stackIdx].push({ type: "apply", key: "", args });
      onApply(stack);
      return Reflect.apply(_, __, args);
    }
  });
  return new Proxy(target, handler());
} /* v9-b88a53fc6df1f8a0 */
